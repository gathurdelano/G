// Hitung tinggi konten proof yang akan didownload
const tempMeasure = document.createElement('div');
tempMeasure.style.position = 'fixed';
tempMeasure.style.left = '-9999px';
tempMeasure.style.top = '-9999px';
tempMeasure.style.width = '620px';
tempMeasure.style.padding = '0';
tempMeasure.style.backgroundColor = '#ffffff';

const clonedContentForMeasure = proofElement.cloneNode(true);
clonedContentForMeasure.style.background = 'none';
clonedContentForMeasure.style.border = 'none';
clonedContentForMeasure.style.boxShadow = 'none';
clonedContentForMeasure.style.borderRadius = '0';
clonedContentForMeasure.style.padding = '0';
clonedContentForMeasure.style.width = '620px';
clonedContentForMeasure.style.maxWidth = '620px';

tempMeasure.appendChild(clonedContentForMeasure);
document.body.appendChild(tempMeasure);

// Tunggu sebentar untuk render, lalu ukur tinggi
setTimeout(() => {
    const contentHeight = tempMeasure.offsetHeight;
    const additionalPadding = 100; // Tambahan padding atas+bawah
    const finalHeight = contentHeight + additionalPadding;
    
    // Hapus elemen pengukur
    document.body.removeChild(tempMeasure);
    
    // Buat container untuk download dengan tinggi yang sesuai
    const tempContainer = document.createElement('div');
    tempContainer.style.position = 'fixed';
    tempContainer.style.left = '-9999px';
    tempContainer.style.top = '-9999px';
    tempContainer.style.width = '700px'; // LEBAR TETAP 700px
    tempContainer.style.height = `${finalHeight}px`; // TINGGI MENYESUAIKAN KONTEN
    tempContainer.style.padding = `${additionalPadding/2}px 40px`;
    tempContainer.style.backgroundColor = '#ffffff';
    
    // Efek kertas bergaris
    tempContainer.style.backgroundImage = `
        linear-gradient(rgba(250, 250, 250, 0.8), rgba(250, 250, 250, 0.8)),
        repeating-linear-gradient(0deg, transparent, transparent 24px, #e0e0e0 24px, #e0e0e0 25px)
    `;
    tempContainer.style.backgroundSize = 'auto, auto 25px';
    
    // ... (sisa kode)
    
    html2canvas(tempContainer, {
        scale: 2,
        backgroundColor: null,
        useCORS: true,
        width: 700,
        height: finalHeight,
        logging: false
    }).then(canvas => {
        // ... (sisa kode)
    });
}, 100);
