<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dark Red Spinner - Jarum Tepat</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }
        
        body {
            background: linear-gradient(135deg, #1a0000 0%, #0a0000 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
            overflow-x: hidden;
            color: white;
        }
        
        .container {
            width: 100%;
            max-width: 900px;
            text-align: center;
            position: relative;
            z-index: 10;
        }
        
        header {
            margin-bottom: 40px;
        }
        
        h1 {
            color: #fff;
            font-size: 3rem;
            margin-bottom: 15px;
            text-shadow: 0 0 25px rgba(255, 0, 0, 0.8);
            letter-spacing: 2px;
            background: linear-gradient(to right, #ffcccc, #ff6666, #ff0000);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .warning {
            color: #ff0000;
            font-size: 1.3rem;
            font-weight: 700;
            margin: 15px 0;
            text-transform: uppercase;
            letter-spacing: 1px;
            text-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
            border: 2px solid #ff0000;
            padding: 10px 20px;
            border-radius: 10px;
            display: inline-block;
            background: rgba(139, 0, 0, 0.2);
        }
        
        .spinner-wrapper {
            position: relative;
            width: 450px;
            height: 450px;
            margin: 40px auto;
        }
        
        /* JARUM YANG SANGAT TEPAT DAN TIDAK BERGERAK */
        .exact-pointer-container {
            position: absolute;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 100%;
            z-index: 100;
            pointer-events: none;
        }
        
        .exact-pointer-line {
            position: absolute;
            width: 4px;
            height: 230px;
            background: linear-gradient(to bottom, 
                rgba(255, 255, 255, 0.9) 0%,
                rgba(255, 0, 0, 1) 30%,
                rgba(255, 0, 0, 1) 70%,
                rgba(255, 255, 255, 0.9) 100%);
            top: 0;
            left: 0;
            box-shadow: 
                0 0 15px rgba(255, 0, 0, 0.9),
                0 0 30px rgba(255, 0, 0, 0.7);
        }
        
        .exact-pointer-arrow {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 12px solid transparent;
            border-right: 12px solid transparent;
            border-bottom: 25px solid #ff0000;
            filter: drop-shadow(0 0 10px rgba(255, 0, 0, 0.9));
        }
        
        .exact-pointer-dot {
            position: absolute;
            width: 20px;
            height: 20px;
            background: #ff0000;
            border-radius: 50%;
            top: -35px;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.9);
            border: 3px solid white;
        }
        
        /* GUIDE LINE UNTUK MEMASTIKAN KETEPATAN */
        .guide-lines {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 90;
        }
        
        .guide-line-vertical {
            position: absolute;
            width: 1px;
            height: 100%;
            background: rgba(255, 255, 255, 0.2);
            left: 50%;
            transform: translateX(-50%);
        }
        
        .guide-line-horizontal {
            position: absolute;
            width: 100%;
            height: 1px;
            background: rgba(255, 255, 255, 0.2);
            top: 50%;
            transform: translateY(-50%);
        }
        
        .spinner {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            position: relative;
            box-shadow: 
                0 0 0 20px #5a0000,
                0 0 40px rgba(139, 0, 0, 0.8),
                inset 0 0 60px rgba(0, 0, 0, 0.95);
            transition: transform 0.1s linear;
            background: #150000;
            cursor: grab;
            overflow: visible;
            border: 10px solid #8b0000;
            touch-action: none;
        }
        
        .spinner:active {
            cursor: grabbing;
        }
        
        .spinner-center {
            position: absolute;
            width: 60px;
            height: 60px;
            background: #ff0000;
            border-radius: 50%;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 30;
            box-shadow: 
                0 0 30px rgba(255, 0, 0, 0.9),
                inset 0 0 15px rgba(255, 255, 255, 0.4);
            border: 6px solid white;
        }
        
        .spinner-section {
            position: absolute;
            width: 50%;
            height: 50%;
            transform-origin: bottom right;
            overflow: hidden;
            clip-path: polygon(0 0, 100% 0, 100% 100%);
        }
        
        .spinner-section-content {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            transform: rotate(45deg);
            font-weight: 900;
            color: white;
            padding-left: 45px;
            padding-bottom: 45px;
            font-size: 26px;
            text-shadow: 
                2px 2px 4px rgba(0, 0, 0, 0.9),
                0 0 15px rgba(255, 255, 255, 0.6);
            letter-spacing: 1.5px;
        }
        
        /* INDIKATOR ANGKA YANG SEDANG DI JARUM */
        .number-indicator {
            position: absolute;
            top: -80px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 0, 0, 0.9);
            color: white;
            padding: 12px 25px;
            border-radius: 30px;
            font-size: 1.8rem;
            font-weight: 900;
            z-index: 110;
            box-shadow: 0 0 20px rgba(255, 0, 0, 0.7);
            border: 3px solid white;
            min-width: 80px;
            text-align: center;
            pointer-events: none;
        }
        
        .result-container {
            background: linear-gradient(145deg, #2a0000, #1a0000);
            border-radius: 20px;
            padding: 35px;
            margin: 40px auto;
            width: 90%;
            max-width: 600px;
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.7),
                inset 0 0 30px rgba(139, 0, 0, 0.3);
            border: 3px solid #8b0000;
            position: relative;
            overflow: hidden;
        }
        
        .result-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 8px;
            background: linear-gradient(to right, 
                #ff0000, #ff6666, #ff0000);
            box-shadow: 0 0 15px rgba(255, 0, 0, 0.7);
        }
        
        .result-label {
            color: #ffcccc;
            font-size: 1.5rem;
            margin-bottom: 25px;
            font-weight: 600;
            letter-spacing: 1px;
        }
        
        .result-number {
            font-size: 7rem;
            color: #ff0000;
            font-weight: 900;
            text-align: center;
            text-shadow: 
                0 0 25px rgba(255, 0, 0, 0.9),
                0 0 50px rgba(255, 0, 0, 0.5);
            margin: 20px 0;
            line-height: 1;
        }
        
        .result-prompt {
            background: rgba(26, 0, 0, 0.9);
            border-radius: 15px;
            padding: 25px;
            margin-top: 25px;
            border: 2px solid #8b0000;
            text-align: left;
            max-height: 220px;
            overflow-y: auto;
        }
        
        .prompt-text {
            color: #ffcccc;
            font-size: 1.1rem;
            line-height: 1.7;
            min-height: 100px;
        }
        
        .instructions {
            background: rgba(42, 0, 0, 0.8);
            border-radius: 15px;
            padding: 25px;
            margin-top: 30px;
            max-width: 700px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 2px solid #8b0000;
        }
        
        .instructions h3 {
            color: #ff6666;
            margin-bottom: 20px;
            font-size: 1.6rem;
            text-shadow: 0 0 10px rgba(255, 102, 102, 0.5);
        }
        
        .instructions p {
            color: #ff9999;
            line-height: 1.8;
            font-size: 1.2rem;
        }
        
        /* ANIMASI UNTUK ANGKA YANG TEPAT DI JARUM */
        @keyframes exactMatch {
            0%, 100% { 
                transform: scale(1);
                box-shadow: 0 0 20px rgba(255, 0, 0, 0.7);
            }
            50% { 
                transform: scale(1.1);
                box-shadow: 0 0 40px rgba(255, 0, 0, 0.9);
            }
        }
        
        .exact-match {
            animation: exactMatch 0.5s 3;
        }
        
        /* Warna angka di spinner */
        .spinner-section:nth-child(odd) .spinner-section-content {
            background: linear-gradient(135deg, 
                rgba(139, 0, 0, 0.95) 0%,
                rgba(178, 34, 34, 0.95) 100%);
        }
        
        .spinner-section:nth-child(even) .spinner-section-content {
            background: linear-gradient(135deg, 
                rgba(165, 42, 42, 0.95) 0%,
                rgba(205, 92, 92, 0.95) 100%);
        }
        
        .spinner-section:nth-child(3n) .spinner-section-content {
            background: linear-gradient(135deg, 
                rgba(128, 0, 0, 0.95) 0%,
                rgba(160, 0, 0, 0.95) 100%);
        }
        
        .spinner-section:nth-child(5n) .spinner-section-content {
            background: linear-gradient(135deg, 
                rgba(220, 20, 60, 0.95) 0%,
                rgba(255, 99, 71, 0.95) 100%);
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .spinner-wrapper {
                width: 350px;
                height: 350px;
            }
            
            .exact-pointer-line {
                height: 180px;
            }
            
            .spinner-section-content {
                font-size: 20px;
                padding-left: 35px;
                padding-bottom: 35px;
            }
            
            .result-number {
                font-size: 5rem;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .warning {
                font-size: 1.1rem;
                padding: 8px 15px;
            }
        }
        
        @media (max-width: 480px) {
            .spinner-wrapper {
                width: 300px;
                height: 300px;
            }
            
            .exact-pointer-line {
                height: 150px;
            }
            
            .spinner-section-content {
                font-size: 18px;
                padding-left: 30px;
                padding-bottom: 30px;
            }
            
            .result-number {
                font-size: 4rem;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .number-indicator {
                font-size: 1.4rem;
                padding: 10px 20px;
                top: -70px;
            }
        }
        
        /* Efek visual */
        .blood-effect {
            position: absolute;
            border-radius: 50%;
            opacity: 0.1;
            z-index: 1;
            background: radial-gradient(circle, #ff0000, #8b0000);
            filter: blur(8px);
        }
        
        .blood-1 {
            width: 120px;
            height: 120px;
            top: 10%;
            left: 5%;
            animation: floatBlood 25s infinite ease-in-out;
        }
        
        .blood-2 {
            width: 180px;
            height: 180px;
            bottom: 15%;
            right: 8%;
            animation: floatBlood 30s infinite ease-in-out reverse;
        }
        
        @keyframes floatBlood {
            0%, 100% {
                transform: translateY(0) rotate(0deg) scale(1);
            }
            50% {
                transform: translateY(-60px) rotate(180deg) scale(1.2);
            }
        }
        
        /* SNAP INDICATOR - menunjukkan ketika tepat di jarum */
        .snap-indicator {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 450px;
            height: 450px;
            border-radius: 50%;
            border: 3px solid rgba(0, 255, 0, 0.5);
            pointer-events: none;
            opacity: 0;
            z-index: 80;
            transition: opacity 0.3s;
        }
        
        .snap-active {
            opacity: 1;
            animation: snapPulse 0.5s;
        }
        
        @keyframes snapPulse {
            0%, 100% { 
                border-width: 3px;
                opacity: 0.5;
            }
            50% { 
                border-width: 6px;
                opacity: 0.8;
            }
        }
    </style>
</head>
<body>
    <!-- Efek darah -->
    <div class="blood-effect blood-1"></div>
    <div class="blood-effect blood-2"></div>
    
    <div class="container">
        <header>
            <h1>DARK RED SPINNER - JARUM TEPAT</h1>
            <div class="warning">HANYA ANGKA YANG TEPAT SEGARIS DENGAN JARUM YANG TERPILIH!</div>
            <p style="color: #ff9999; font-size: 1.2rem; max-width: 800px; margin: 20px auto;">
                Putar spinner dengan sentuhan. Angka hanya terpilih jika BERPAPASAN TEPAT dengan garis jarum merah di atas.
            </p>
        </header>
        
        <div class="spinner-wrapper">
            <!-- Garis panduan -->
            <div class="guide-lines">
                <div class="guide-line-vertical"></div>
                <div class="guide-line-horizontal"></div>
            </div>
            
            <!-- JARUM TEPAT DI ATAS -->
            <div class="exact-pointer-container">
                <div class="exact-pointer-dot"></div>
                <div class="exact-pointer-arrow"></div>
                <div class="exact-pointer-line"></div>
            </div>
            
            <!-- Indikator angka yang sedang di jarum -->
            <div class="number-indicator" id="number-indicator">-</div>
            
            <!-- Snap indicator -->
            <div class="snap-indicator" id="snap-indicator"></div>
            
            <!-- Spinner -->
            <div class="spinner" id="spinner">
                <!-- Angka 1-20 akan dibuat oleh JavaScript -->
            </div>
            
            <!-- Titik tengah spinner -->
            <div class="spinner-center"></div>
        </div>
        
        <div class="result-container">
            <div class="result-label">ANGKA YANG TEPAT DI JARUM:</div>
            <div class="result-number" id="result-number">-</div>
            
            <div class="result-label">PROMPT CERITA:</div>
            <div class="result-prompt">
                <div class="prompt-text" id="prompt-text">Putar spinner sampai angka tepat segaris dengan jarum merah di atas</div>
            </div>
        </div>
        
        <div class="instructions">
            <h3>PERATURAN TEPAT:</h3>
            <p>1. JARUM TETAP DI POSISI ATAS (12 jam) - TIDAK BERGERAK<br>
               2. SPINNER BERPUTAR SAAT DISENTUH/DIGESER<br>
               3. ANGKA HANYA TERPILIH JIKA TEPAT BERPAPASAN DENGAN GARIS JARUM<br>
               4. TIDAK ADA OPSI ACAK - ANDA KENDALIKAN PUTARAN<br>
               5. INDIKATOR ANGKA MENUNJUKKAN ANGKA YANG SEDANG DI JARUM<br>
               6. PUTAR PELAN-PELAN UNTUK KETEPATAN MAKSIMAL</p>
        </div>
    </div>

    <script>
        // Prompt untuk setiap angka (1-20)
        const prompts = [
            "Seorang ilmuwan menemukan cara berkomunikasi dengan tanaman yang memperingatkan ancaman global. Haruskah dia mempercayai mereka dan mengambil tindakan?",
            "Di dunia di mana setiap orang memiliki jam kematian di pergelangan tangan, seseorang menemukan jam mereka berhenti. Apakah ini keabadian atau kesalahan?",
            "Karakter utama bermimpi kehidupan berbeda setiap malam, lalu bertemu orang dari mimpi itu di dunia nyata. Apakah mimpi itu dunia paralel?",
            "Kota kecil terperangkap dalam pengulangan hari yang sama. Hanya satu orang yang sadar dan harus memecahkan siklus waktu ini.",
            "Setelah kecelakaan, seseorang bisa melihat 'jejak emosi' di tempat-tempat. Kemampuan ini membantu memecahkan misteri tetapi membebani emosinya.",
            "Di masa depan, kenangan bisa dibeli dan dijual. Seorang penyelundup menemukan kenangan terlarang yang bisa mengubah masyarakat selamanya.",
            "Karakter dalam buku mulai muncul di dunia nyata. Awalnya menyenangkan sampai antagonisnya juga muncul dan mengancam kehidupan.",
            "Setiap orang punya binatang roh. Karakter utama adalah satu-satunya dengan dua binatang roh yang bertentangan, mencerminkan konflik batinnya.",
            "Teknologi baru memungkinkan orang mengunjungi kenangan orang lain. Seorang penyidik menggunakannya untuk memecahkan kejahatan dengan masuk ke kenangan korban.",
            "Di dunia tanpa perang, semua konflik diselesaikan lewat permainan kompetitif. Sang juara tak terkalahkan mulai mempertanyakan moralitas sistem ini.",
            "Setiap kali tidur, karakter utama bangun di tubuh orang berbeda. Mereka harus selesaikan misi sebelum tertidur lagi atau terjebak selamanya.",
            "Portal ke dunia fantasi terbuka di tengah kota. Seorang polisi biasa harus menjaga ketertiban saat makhluk ajaib memasuki dunia kita.",
            "Orang-orang dapat kekuatan super berdasarkan kepribadian. Karakter utama dapat kekuatan yang tampak tidak berguna sampai dia temukan aplikasi mengejutkan.",
            "Sejarah ternyata program komputer yang sedang di-debug. Karakter utama adalah bug yang sadar eksistensinya dan harus hindari 'debugger'.",
            "Setiap kata yang diucapkan muncul sebagai simbol di udara. Karakter utama menemukan dia bisa membaca simbol semua orang dengan makna berbeda.",
            "Waktu berjalan lebih cepat di beberapa wilayah Bumi. Seseorang tinggal di perbatasan zona waktu normal dan cepat, mengalami dua realitas sekaligus.",
            "Emosi manusia bisa dikristalisasi jadi benda fisik dengan kekuatan magis. Seorang kolektor tidak sengaja temukan kristal berisi emosi terlarang.",
            "Setiap bulan purnama, semua orang berubah jadi versi ideal diri mereka. Satu orang tidak berubah, menyadari dia sudah jadi versi idealnya.",
            "Buku di perpustakaan tertentu bisa bawa pembaca masuk ke dunia dalam cerita. Seorang pustakawan harus selamatkan orang yang terjebak dalam buku.",
            "Suara batin semua orang tiba-tiba bisa didengar orang lain. Masyarakat kacau saat orang berjuang bedakan antara pikiran pribadi dan ucapan publik."
        ];
        
        // DOM Elements
        const spinner = document.getElementById('spinner');
        const resultNumber = document.getElementById('result-number');
        const promptText = document.getElementById('prompt-text');
        const numberIndicator = document.getElementById('number-indicator');
        const snapIndicator = document.getElementById('snap-indicator');
        
        // Variables
        let currentRotation = 0;
        let isDragging = false;
        let startX = 0;
        let startY = 0;
        let startRotation = 0;
        let selectedNumber = 0;
        let lastNumberAtPointer = 0;
        const totalNumbers = 20;
        const anglePerNumber = 360 / totalNumbers; // 18 derajat per angka
        
        // Initialize spinner dengan angka 1-20
        function initSpinner() {
            spinner.innerHTML = '';
            
            for (let i = 0; i < totalNumbers; i++) {
                const section = document.createElement('div');
                section.className = 'spinner-section';
                section.style.transform = `rotate(${i * anglePerNumber}deg)`;
                
                const content = document.createElement('div');
                content.className = 'spinner-section-content';
                content.textContent = i + 1; // Angka 1-20
                content.id = `number-${i + 1}`;
                
                section.appendChild(content);
                spinner.appendChild(section);
            }
            
            // Setup event listeners
            setupEventListeners();
            
            // Update angka di indikator
            updateNumberAtPointer();
        }
        
        // Setup event listeners untuk mouse dan touch
        function setupEventListeners() {
            // Mouse events
            spinner.addEventListener('mousedown', startDrag);
            document.addEventListener('mousemove', drag);
            document.addEventListener('mouseup', endDrag);
            
            // Touch events
            spinner.addEventListener('touchstart', handleTouchStart);
            spinner.addEventListener('touchmove', handleTouchMove);
            spinner.addEventListener('touchend', handleTouchEnd);
            
            // Prevent default touch actions
            spinner.addEventListener('touchstart', (e) => e.preventDefault());
        }
        
        // Mulai drag dengan mouse
        function startDrag(e) {
            e.preventDefault();
            isDragging = true;
            startX = e.clientX;
            startY = e.clientY;
            startRotation = currentRotation;
            spinner.style.cursor = 'grabbing';
            spinner.style.transition = 'none';
        }
        
        // Drag dengan mouse
        function drag(e) {
            if (!isDragging) return;
            e.preventDefault();
            
            const deltaX = e.clientX - startX;
            const deltaY = e.clientY - startY;
            
            // Hitung perubahan rotasi berdasarkan pergerakan mouse
            // Sensitivitas disesuaikan untuk kontrol yang tepat
            const rotationChange = (deltaX + deltaY) * 0.5;
            
            // Update rotasi
            currentRotation = startRotation + rotationChange;
            
            // Terapkan rotasi
            spinner.style.transform = `rotate(${currentRotation}deg)`;
            
            // Update angka yang sedang di jarum
            updateNumberAtPointer();
            
            // Cek apakah ada angka yang tepat di jarum
            checkExactMatch();
        }
        
        // Akhiri drag dengan mouse
        function endDrag(e) {
            if (!isDragging) return;
            isDragging = false;
            spinner.style.cursor = 'grab';
            
            // Snap ke angka terdekat jika dekat
            snapToNearestNumber();
        }
        
        // Handle touch start
        function handleTouchStart(e) {
            e.preventDefault();
            if (e.touches.length === 1) {
                isDragging = true;
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
                startRotation = currentRotation;
                spinner.style.transition = 'none';
            }
        }
        
        // Handle touch move
        function handleTouchMove(e) {
            if (!isDragging || e.touches.length !== 1) return;
            e.preventDefault();
            
            const deltaX = e.touches[0].clientX - startX;
            const deltaY = e.touches[0].clientY - startY;
            
            // Hitung perubahan rotasi
            const rotationChange = (deltaX + deltaY) * 0.7;
            
            // Update rotasi
            currentRotation = startRotation + rotationChange;
            
            // Terapkan rotasi
            spinner.style.transform = `rotate(${currentRotation}deg)`;
            
            // Update angka yang sedang di jarum
            updateNumberAtPointer();
            
            // Cek apakah ada angka yang tepat di jarum
            checkExactMatch();
        }
        
        // Handle touch end
        function handleTouchEnd(e) {
            if (!isDragging) return;
            isDragging = false;
            
            // Snap ke angka terdekat jika dekat
            snapToNearestNumber();
        }
        
        // Update angka yang sedang berada di jarum
        function updateNumberAtPointer() {
            // Normalisasi rotasi ke 0-360
            let normalizedRotation = currentRotation % 360;
            if (normalizedRotation < 0) normalizedRotation += 360;
            
            // Jarum di posisi 0 derajat (atas)
            // Hitung angka mana yang ada di posisi 0 derajat
            // Rumus: (360 - rotasi) / 18 derajat per angka
            let numberAtPointer = Math.round((360 - normalizedRotation) / anglePerNumber) % totalNumbers;
            numberAtPointer = (numberAtPointer + totalNumbers) % totalNumbers;
            
            // Konversi ke 1-20 (bukan 0-19)
            let displayNumber = numberAtPointer + 1;
            
            // Update indikator
            numberIndicator.textContent = displayNumber;
            lastNumberAtPointer = displayNumber;
        }
        
        // Cek apakah ada angka yang tepat segaris dengan jarum
        function checkExactMatch() {
            // Normalisasi rotasi
            let normalizedRotation = currentRotation % 360;
            if (normalizedRotation < 0) normalizedRotation += 360;
            
            // Hitung offset dari angka terdekat
            let angleOffset = (360 - normalizedRotation) % anglePerNumber;
            if (angleOffset > anglePerNumber / 2) angleOffset = anglePerNumber - angleOffset;
            
            // Jika offset sangat kecil (kurang dari 0.5 derajat), berarti tepat segaris
            const tolerance = 0.5; // derajat
            
            if (angleOffset < tolerance) {
                // Tampilkan snap indicator
                snapIndicator.classList.add('snap-active');
                
                // Dapatkan angka yang tepat
                let exactNumber = Math.round((360 - normalizedRotation) / anglePerNumber) % totalNumbers;
                exactNumber = (exactNumber + totalNumbers) % totalNumbers;
                exactNumber += 1;
                
                // Update indikator dengan warna hijau
                numberIndicator.style.background = 'rgba(0, 255, 0, 0.9)';
                numberIndicator.style.boxShadow = '0 0 20px rgba(0, 255, 0, 0.7)';
                
                // Jika angka ini berbeda dengan sebelumnya, update hasil
                if (selectedNumber !== exactNumber) {
                    selectedNumber = exactNumber;
                    displayResult();
                }
            } else {
                // Reset snap indicator
                snapIndicator.classList.remove('snap-active');
                numberIndicator.style.background = 'rgba(255, 0, 0, 0.9)';
                numberIndicator.style.boxShadow = '0 0 20px rgba(255, 0, 0, 0.7)';
            }
        }
        
        // Snap ke angka terdekat
        function snapToNearestNumber() {
            // Normalisasi rotasi
            let normalizedRotation = currentRotation % 360;
            if (normalizedRotation < 0) normalizedRotation += 360;
            
            // Hitung angka terdekat
            let targetNumber = Math.round((360 - normalizedRotation) / anglePerNumber) % totalNumbers;
            targetNumber = (targetNumber + totalNumbers) % totalNumbers;
            
            // Hitung rotasi target
            let targetRotation = 360 - (targetNumber * anglePerNumber);
            
            // Animasikan ke posisi target
            spinner.style.transition = 'transform 0.5s cubic-bezier(0.34, 1.56, 0.64, 1)';
            spinner.style.transform = `rotate(${targetRotation}deg)`;
            
            // Update rotasi saat ini
            currentRotation = targetRotation;
            
            // Update angka di indikator
            updateNumberAtPointer();
            
            // Set angka yang terpilih
            selectedNumber = targetNumber + 1;
            
            // Tampilkan hasil setelah animasi selesai
            setTimeout(() => {
                displayResult();
                
                // Highlight angka yang tepat
                highlightExactNumber(targetNumber);
            }, 600);
        }
        
        // Highlight angka yang tepat di jarum
        function highlightExactNumber(numberIndex) {
            // Reset semua highlight
            const sections = document.querySelectorAll('.spinner-section-content');
            sections.forEach(section => {
                section.style.filter = 'none';
                section.style.transform = 'rotate(45deg)';
            });
            
            // Highlight angka yang tepat
            const exactSection = document.getElementById(`number-${numberIndex + 1}`);
            if (exactSection) {
                exactSection.style.filter = 'brightness(1.5) drop-shadow(0 0 15px white)';
                exactSection.style.transform = 'rotate(45deg) scale(1.1)';
                exactSection.parentElement.classList.add('exact-match');
                
                // Hapus animasi setelah selesai
                setTimeout(() => {
                    exactSection.parentElement.classList.remove('exact-match');
                }, 1500);
            }
        }
        
        // Tampilkan hasil
        function displayResult() {
            // Update angka hasil
            resultNumber.textContent = selectedNumber;
            
            // Animasi muncul
            resultNumber.style.animation = 'none';
            setTimeout(() => {
                resultNumber.style.animation = 'exactMatch 0.5s 3';
            }, 10);
            
            // Update prompt
            promptText.textContent = prompts[selectedNumber - 1];
            
            // Tambah efek suara (simulasi)
            playSelectSound();
        }
        
        // Play sound effect
        function playSelectSound() {
            // Simulasi suara klik
            try {
                // Create a simple click sound using Web Audio API
                const audioContext = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.value = 800;
                oscillator.type = 'sine';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.1);
            } catch (e) {
                console.log("Audio not supported");
            }
        }
        
        // Initialize saat halaman dimuat
        window.addEventListener('DOMContentLoaded', initSpinner);
        
        // Tambah keyboard controls untuk testing (bisa dihapus di production)
        document.addEventListener('keydown', (e) => {
            // Arrow keys untuk kontrol tepat
            if (e.key === 'ArrowRight') {
                currentRotation -= anglePerNumber;
                spinner.style.transition = 'transform 0.3s ease';
                spinner.style.transform = `rotate(${currentRotation}deg)`;
                updateNumberAtPointer();
                setTimeout(() => snapToNearestNumber(), 350);
            }
            
            if (e.key === 'ArrowLeft') {
                currentRotation += anglePerNumber;
                spinner.style.transition = 'transform 0.3s ease';
                spinner.style.transform = `rotate(${currentRotation}deg)`;
                updateNumberAtPointer();
                setTimeout(() => snapToNearestNumber(), 350);
            }
            
            // Space untuk random (hanya testing)
            if (e.key === ' ' && e.ctrlKey) {
                const randomNum = Math.floor(Math.random() * 20) + 1;
                const targetRotation = 360 - ((randomNum - 1) * anglePerNumber);
                currentRotation = targetRotation;
                spinner.style.transition = 'transform 1.5s cubic-bezier(0.34, 1.56, 0.64, 1)';
                spinner.style.transform = `rotate(${currentRotation}deg)`;
                updateNumberAtPointer();
                setTimeout(() => {
                    selectedNumber = randomNum;
                    displayResult();
                    highlightExactNumber(randomNum - 1);
                }, 1600);
            }
        });
    </script>
</body>
</html>
